function addAttack(){keyFrames=keyFrames.concat(attack[firstAttack],attack[secondAttack])}function death(){var t=Math.floor(Math.random()*(deathRange[1]-deathRange[0]+1))+deathRange[0];return t}function setAttrs(t,e){for(var a in e)t.setAttribute(a,e[a])}function playAgain(){location.reload()}function deathRatio(t){var e=document.querySelectorAll(".wrap-"+t),a=e.length,n=[death()],r=n[0];for(i=0;i<a;i++){var o=death();if(r+=o,!(r<a)){n.push(a-(r-o));break}n.push(o)}var l=0,m=0;for(i=0;i<n.length;i++){for(j=0;j<n[i];j++)1==roundInterval?e[l].classList.add("hit-"+2*(i+1)):e[l].classList.add("hit-"+(2*(i+1)-1)),l++;m++}console.log(m),totalRounds<m&&(totalRounds=m),console.log(roundInterval),roundInterval=1!=roundInterval}function turnIntervals(){i++;var t=i+1,e=0==animInit?0:1e3*keyFrames[i].duration,a=keyFrames[t].theme,n=keyFrames[t].target,r=keyFrames[t].key,o=document.querySelectorAll(n);turns=setInterval(function(){function t(){b.setAttribute("class",n[l]),l++,l===i&&(l=0)}function e(){clearInterval(themeInterval)}var n=a.split(" "),i=n.length,l=0;if("weapon-disengage"==r){var m=document.querySelectorAll(".hit-"+deathTrigger);for(k=0;k<m.length;k++)m[k].classList.add("dead");for(h=0;h<animalTeam.length;h++){var d=document.querySelectorAll(".animal-"+animalTeam[h]+" .dead"),s=document.querySelectorAll(".animal-"+animalTeam[h]+" .animal-wrap");d.length==s.length&&(console.log("BATTLE OVER"),battleOver=!0,setAttrs(score,{"data-winner":animalTeam[0===h?1:0],"data-loser":animalTeam[0===h?0:1]}))}deathTrigger++}if(o.length>0)for(j=0;j<o.length;j++)o[j].setAttribute("data-anim-key",r);e(),1===i?b.setAttribute("class",a):i>1&&(themeInterval=setInterval(t,100)),clearInterval(turns),1==battleOver?clearInterval(turns):turnIntervals(),animInit=!0},e)}var keyFrames=[{theme:"init",duration:0},{key:"animals-init",target:".main",theme:"init",duration:0},{key:"animals-meet",target:".weapon, .animal",theme:"init",duration:4},{key:"animals-stare",target:".main",theme:"init",duration:.5},{key:"animals-talk-in",target:".animal",theme:"init",duration:4},{key:"animals-talk-out",target:".animal",theme:"init",duration:1}],attack=[[{key:"raygun-engage-charge",target:".main",theme:"init",duration:1.2},{key:"raygun-engage-shoot",target:".main",theme:"laser-1 laser-2",duration:.75},{key:"raygun-engage-hit",target:".main",theme:"laser-hit-1 laser-hit-2",duration:2},{key:"weapon-disengage",target:".main",theme:"init",duration:3},{key:"",target:".main",theme:"init",duration:0}],[{key:"cannon-engage-aim",target:".main",theme:"init",duration:1.8},{key:"cannon-engage-shoot",target:".main",theme:"light",duration:1},{key:"cannon-engage-hit",target:".main",theme:"expl-1 expl-2 expl-3",duration:1.5},{key:"weapon-disengage",target:".main",theme:"init",duration:3},{key:"",target:".main",theme:"init",duration:0}]],firstAttack=Math.round(Math.random()),secondAttack=1==firstAttack?0:1,deathRange=[2,15],totalRounds=0,roundInterval=!0,animalTeam=["cat","dog"],score=document.querySelector(".score"),play=document.querySelector(".play");for(deathRatio(animalTeam[firstAttack]),deathRatio(animalTeam[secondAttack]),i=0;i<totalRounds;i++)addAttack();var i=-1,b=document.querySelector("body"),animTime=keyFrames[0].duration,animInit=!1,themeInterval="",deathTrigger=1,battleOver=!1;b.setAttribute("class",keyFrames[0].theme),turnIntervals(),play.addEventListener("click",function(){playAgain()});