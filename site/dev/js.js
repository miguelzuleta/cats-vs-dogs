function addAttack(){keyFrames=keyFrames.concat(attack[firstAttack],attack[secondAttack])}function death(){var t=Math.floor(Math.random()*(deathRange[1]-deathRange[0]+1))+deathRange[0];return t}function setAttrs(t,e){for(var a in e)t.setAttribute(a,e[a])}function playAgain(){location.reload()}function deathRatio(t){var e=document.querySelectorAll(".wrap-"+t),a=e.length,n=[death()],r=n[0];for(i=0;i<a;i++){var l=death();if(r+=l,!(r<a)){n.push(a-(r-l));break}n.push(l)}var o=0,s=0;for(i=0;i<n.length;i++){for(j=0;j<n[i];j++)1==roundInterval?e[o].classList.add("hit-"+2*(i+1)):e[o].classList.add("hit-"+(2*(i+1)-1)),o++;s++}console.log(s),totalRounds<s&&(totalRounds=s),console.log(roundInterval),roundInterval=1!=roundInterval}function turnIntervals(){i++;var t=i+1,e=0==animInit?0:1e3*keyFrames[i].duration,a=keyFrames[t].theme,n=keyFrames[t].target,r=keyFrames[t].key,l=document.querySelectorAll(n);turns=setInterval(function(){function t(){b.setAttribute("class",n[o]),o++,o===i&&(o=0)}function e(){clearInterval(themeInterval)}var n=a.split(" "),i=n.length,o=0;if("weapon-disengage"==r){var s=document.querySelectorAll(".hit-"+deathTrigger);for(k=0;k<s.length;k++)s[k].classList.add("dead");for(h=0;h<animalTeam.length;h++){var c=document.querySelectorAll(".animal-"+animalTeam[h]+" .dead"),d=document.querySelectorAll(".animal-"+animalTeam[h]+" .animal-wrap");c.length==d.length&&(console.log("BATTLE OVER"),battleOver=!0,setAttrs(score,{"data-winner":animalTeam[0===h?1:0],"data-loser":animalTeam[0===h?0:1]}))}deathTrigger++}if(l.length>0)for(j=0;j<l.length;j++)l[j].setAttribute("data-anim-key",r);e(),1===i?b.setAttribute("class",a):i>1&&(themeInterval=setInterval(t,100)),clearInterval(turns),1==battleOver?clearInterval(turns):turnIntervals(),animInit=!0},e)}var firstAttack=Math.round(Math.random()),secondAttack=1==firstAttack?0:1,deathRange=[2,15],totalRounds=0,roundInterval=!0,animalTeam=["cat","dog"],score=document.querySelector(".score"),play=document.querySelector(".play");for(deathRatio(animalTeam[firstAttack]),deathRatio(animalTeam[secondAttack]),i=0;i<totalRounds;i++)addAttack();var i=-1,b=document.querySelector("body"),animTime=keyFrames[0].duration,animInit=!1,themeInterval="",deathTrigger=1,battleOver=!1;b.setAttribute("class",keyFrames[0].theme),turnIntervals(),play.addEventListener("click",function(){playAgain()});